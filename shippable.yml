language: python

env:
  - DATABASE=sqlite
  - DATABASE=postgresql

build:
  pre_ci_boot:
    image_name: library/ubuntu
    image_tag: 16.04
    pull: true

  ci:
    - apt-get -y install language-pack-en python3-pip python3-pygit2
    - pip3 install --upgrade pip
    - pip3 install coverage
    - pip3 install Django==1.10
    - pip3 install pep8
    - pip3 install pylint
    - pip3 install unittest-xml-reporting
    - ./style.sh
    - ./dbinit.sh
    - git clone https://github.com/DronMDF/test.git /tmp/test
    - coverage run ./manage.py test --testrunner=xmlrunner.extra.djangotestrunner.XMLTestRunner
    - ./manage.py migrate
    - find ./ -name "*.py" | xargs coverage xml -o shippable/codecoverage/coverage.xml
